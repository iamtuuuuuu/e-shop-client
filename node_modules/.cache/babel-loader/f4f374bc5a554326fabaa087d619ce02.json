{"remainingRequest":"/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/node_modules/thread-loader/dist/cjs.js!/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/node_modules/babel-loader/lib/index.js!/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/src/composables/useUsersAuthentication.js","dependencies":[{"path":"/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/src/composables/useUsersAuthentication.js","mtime":1621152090012},{"path":"/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY29tcHV0ZWQsIHdhdGNoIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgdXNlUm91dGUsIHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwpleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VVc2VycygpIHsKICB2YXIgX3JvdXRlJHF1ZXJ5JHJlZGlyZWN0OwoKICB2YXIgc3RvcmUgPSB1c2VTdG9yZSgpOwogIHZhciByb3V0ZSA9IHVzZVJvdXRlKCk7CiAgdmFyIHJvdXRlciA9IHVzZVJvdXRlcigpOwogIHZhciB1c2VyID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHN0b3JlLmdldHRlcnNbJ2dldExvZ2dlZFVzZXInXTsKICB9KTsKCiAgdmFyIGxvZ2luVXNlciA9IGZ1bmN0aW9uIGxvZ2luVXNlcih1c2VyKSB7CiAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ2xvZ2luVXNlcicsIHVzZXIpOwogIH07CgogIHZhciByZWdpc3RlclVzZXIgPSBmdW5jdGlvbiByZWdpc3RlclVzZXIodXNlcikgewogICAgdXNlci5wYXNzd29yZCAhPT0gdXNlci5jb25maXJtUGFzc3dvcmQgPyBzdG9yZS5jb21taXQoJ3V0aWxzL3NldEVycm9yJywgewogICAgICBtZXNzYWdlOiAnVGhlIHBhc3N3b3JkIGNvbmZpcm1hdGlvbiBtdXN0IG1hdGNoJwogICAgfSwgewogICAgICByb290OiB0cnVlCiAgICB9KSA6IHN0b3JlLmRpc3BhdGNoKCdyZWdpc3RlclVzZXInLCB1c2VyKTsKICB9OwoKICB2YXIgbG9nb3V0VXNlciA9IGZ1bmN0aW9uIGxvZ291dFVzZXIoKSB7CiAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ2xvZ291dFVzZXInKTsKICB9OwoKICB2YXIgcmVkaXJlY3QgPSAoX3JvdXRlJHF1ZXJ5JHJlZGlyZWN0ID0gcm91dGUucXVlcnkucmVkaXJlY3QpICE9PSBudWxsICYmIF9yb3V0ZSRxdWVyeSRyZWRpcmVjdCAhPT0gdm9pZCAwID8gX3JvdXRlJHF1ZXJ5JHJlZGlyZWN0IDogJyc7CgogIHZhciByZWRpcmVjdFdhdGNoID0gZnVuY3Rpb24gcmVkaXJlY3RXYXRjaCgpIHsKICAgIHJldHVybiB3YXRjaCh1c2VyLnZhbHVlLCBmdW5jdGlvbiAodXNlcikgewogICAgICBpZiAodXNlci5faWQpIHJvdXRlci5wdXNoKCIvIi5jb25jYXQocmVkaXJlY3QpKTsKICAgIH0sIHsKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9KTsKICB9OwoKICByZXR1cm4gewogICAgdXNlcjogdXNlciwKICAgIGxvZ2luVXNlcjogbG9naW5Vc2VyLAogICAgcmVnaXN0ZXJVc2VyOiByZWdpc3RlclVzZXIsCiAgICBsb2dvdXRVc2VyOiBsb2dvdXRVc2VyLAogICAgcmVkaXJlY3Q6IHJlZGlyZWN0LAogICAgcmVkaXJlY3RXYXRjaDogcmVkaXJlY3RXYXRjaCwKICAgIGlzTG9hZGluZzogY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc3RvcmUuZ2V0dGVyc1sndXRpbHMvaXNMb2FkaW5nJ107CiAgICB9KSwKICAgIGVycm9yOiBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBzdG9yZS5nZXR0ZXJzWyd1dGlscy9nZXRFcnJvciddOwogICAgfSkKICB9Owp9"},{"version":3,"sources":["/home/vuanhtu/Desktop/workspace/nodejs/MEVN/proshop/frontend/src/composables/useUsersAuthentication.js"],"names":["computed","watch","useStore","useRoute","useRouter","useUsers","store","route","router","user","getters","loginUser","dispatch","registerUser","password","confirmPassword","commit","message","root","logoutUser","redirect","query","redirectWatch","value","_id","push","immediate","isLoading","error"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,KAAnB,QAAgC,KAAhC;AACA,SAASC,QAAT,QAAyB,MAAzB;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,YAApC;AAEA,eAAe,SAASC,QAAT,GAAoB;AAAA;;AAC/B,MAAMC,KAAK,GAAGJ,QAAQ,EAAtB;AACA,MAAMK,KAAK,GAAGJ,QAAQ,EAAtB;AACA,MAAMK,MAAM,GAAGJ,SAAS,EAAxB;AAEA,MAAMK,IAAI,GAAGT,QAAQ,CAAC;AAAA,WAAMM,KAAK,CAACI,OAAN,CAAc,eAAd,CAAN;AAAA,GAAD,CAArB;;AAEA,MAAMC,SAAS,GAAG,SAAZA,SAAY,CAAAF,IAAI;AAAA,WAAIH,KAAK,CAACM,QAAN,CAAe,WAAf,EAA4BH,IAA5B,CAAJ;AAAA,GAAtB;;AACA,MAAMI,YAAY,GAAG,SAAfA,YAAe,CAAAJ,IAAI,EAAI;AACzBA,IAAAA,IAAI,CAACK,QAAL,KAAkBL,IAAI,CAACM,eAAvB,GACMT,KAAK,CAACU,MAAN,CAAa,gBAAb,EAA+B;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAA/B,EAAoF;AAAEC,MAAAA,IAAI,EAAE;AAAR,KAApF,CADN,GAEMZ,KAAK,CAACM,QAAN,CAAe,cAAf,EAA+BH,IAA/B,CAFN;AAGH,GAJD;;AAKA,MAAMU,UAAU,GAAG,SAAbA,UAAa;AAAA,WAAMb,KAAK,CAACM,QAAN,CAAe,YAAf,CAAN;AAAA,GAAnB;;AAGA,MAAMQ,QAAQ,4BAAGb,KAAK,CAACc,KAAN,CAAYD,QAAf,yEAA2B,EAAzC;;AACA,MAAME,aAAa,GAAG,SAAhBA,aAAgB;AAAA,WAAMrB,KAAK,CAACQ,IAAI,CAACc,KAAN,EAAa,UAAAd,IAAI,EAAI;AAClD,UAAIA,IAAI,CAACe,GAAT,EAAchB,MAAM,CAACiB,IAAP,YAAgBL,QAAhB;AACjB,KAFgC,EAE9B;AAAEM,MAAAA,SAAS,EAAE;AAAb,KAF8B,CAAX;AAAA,GAAtB;;AAIA,SAAO;AACHjB,IAAAA,IAAI,EAAJA,IADG;AAEHE,IAAAA,SAAS,EAATA,SAFG;AAGHE,IAAAA,YAAY,EAAZA,YAHG;AAIHM,IAAAA,UAAU,EAAVA,UAJG;AAKHC,IAAAA,QAAQ,EAARA,QALG;AAMHE,IAAAA,aAAa,EAAbA,aANG;AAOHK,IAAAA,SAAS,EAAE3B,QAAQ,CAAC;AAAA,aAAMM,KAAK,CAACI,OAAN,CAAc,iBAAd,CAAN;AAAA,KAAD,CAPhB;AAQHkB,IAAAA,KAAK,EAAE5B,QAAQ,CAAC;AAAA,aAAMM,KAAK,CAACI,OAAN,CAAc,gBAAd,CAAN;AAAA,KAAD;AARZ,GAAP;AAUH","sourcesContent":["import { computed, watch } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRoute, useRouter } from 'vue-router'\n\nexport default function useUsers() {\n    const store = useStore()\n    const route = useRoute()\n    const router = useRouter()\n\n    const user = computed(() => store.getters['getLoggedUser'])\n    \n    const loginUser = user => store.dispatch('loginUser', user)\n    const registerUser = user => {\n        user.password !== user.confirmPassword\n            ? store.commit('utils/setError', { message: 'The password confirmation must match' }, { root: true })\n            : store.dispatch('registerUser', user)\n    }\n    const logoutUser = () => store.dispatch('logoutUser')\n\n\n    const redirect = route.query.redirect ?? ''\n    const redirectWatch = () => watch(user.value, user => {\n        if (user._id) router.push(`/${redirect}`)\n    }, { immediate: true })\n    \n    return {\n        user,\n        loginUser,\n        registerUser,\n        logoutUser,\n        redirect,\n        redirectWatch,\n        isLoading: computed(() => store.getters['utils/isLoading']),\n        error: computed(() => store.getters['utils/getError'])\n    } \n}\n"]}]}